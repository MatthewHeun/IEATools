<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Final to Useful Analysis ‚Ä¢ IEATools</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Final to Useful Analysis">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">IEATools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.76</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/IEATools.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/final_to_useful.html">Final to Useful Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/fix_iea_data.html">Fixes for IEA Data</a></li>
    <li><a class="dropdown-item" href="../articles/prep_psut.html">Prepare for PSUT analysis</a></li>
    <li><a class="dropdown-item" href="../articles/psut_names.html">PSUT Names</a></li>
    <li><a class="dropdown-item" href="../articles/specify.html">Specify EIOU Industries and Flows</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Final to Useful Analysis</h1>
                        <h4 data-toc-skip class="author">Matthew Kuperus
Heun</h4>
            
            <h4 data-toc-skip class="date">2024-12-09</h4>
      

      <div class="d-none name"><code>final_to_useful.Rmd</code></div>
    </div>

    
    
<!-- Establish some helpful LaTeX shortcuts for equations -->
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Extended energy balance data from the <a href="https://www.iea.org" class="external-link">International Energy Agency (IEA)</a>
provides both primary and final energy information. (Primary energy is
extracted from the biosphere, and final energy is sold to consumers.)
But consumers don‚Äôt buy final energy for its own sake. They buy final
energy so they can convert it to useful energy (heat, light, work) that,
when combined with infrastructure (buildings, roads, etc.), provides
energy services (heated and cooled space, passenger and freight
transport, etc.).</p>
<p>So some energy conversion chain analyses extend the final energy
provided by the IEA to useful energy through a process that involves</p>
<ol style="list-style-type: lower-alpha">
<li>allocating final energy to final-to-useful energy conversion
machines,</li>
<li>defining the efficiency of those final-to-useful energy conversion
machines, and</li>
<li>calculating the useful energy injected into the the final demand
economic sectors.</li>
</ol>
<p>The <code>IEATools</code> package provides several functions to
assist the process of pushing from final energy to useful energy. This
vignette demonstrates their use and suggests a workflow for this
process.</p>
</div>
<div class="section level2">
<h2 id="allocation">Allocation<a class="anchor" aria-label="anchor" href="#allocation"></a>
</h2>
<p>Extending the IEA‚Äôs extended energy balance data to the useful stage
begins with defining allocations of final energy carriers to
final-to-useful energy conversion machines. To demonstrate this process,
we‚Äôll use the sample IEA data bundled with this package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://matthewheun.github.io/IEATools/">IEATools</a></span><span class="op">)</span></span>
<span><span class="va">Tidy_iea_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_tidy_iea_df.html">load_tidy_iea_df</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/specify_all.html">specify_all</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 429</span></span>
<span><span class="co">#&gt; Columns: 11</span></span>
<span><span class="co">#&gt; $ Country              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "GHA", "GHA", "GHA", "GHA", "GHA", "GHA", "GHA", ‚Ä¶</span></span>
<span><span class="co">#&gt; $ Method               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "PCM", "PCM", "PCM", "PCM", "PCM", "PCM", "PCM", ‚Ä¶</span></span>
<span><span class="co">#&gt; $ EnergyType           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "E", "E", "E", "E", "E", "E", "E", "E", "E", "E",‚Ä¶</span></span>
<span><span class="co">#&gt; $ LastStage            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Final", "Final", "Final", "Final", "Final", "Fin‚Ä¶</span></span>
<span><span class="co">#&gt; $ Year                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1971, 1971, 1971, 1971, 1971, 1971, 1971, 1971, 1‚Ä¶</span></span>
<span><span class="co">#&gt; $ LedgerSide           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Consumption", "Consumption", "Consumption", "Con‚Ä¶</span></span>
<span><span class="co">#&gt; $ FlowAggregationPoint <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Industry", "Industry", "Industry", "Industry", "‚Ä¶</span></span>
<span><span class="co">#&gt; $ Flow                 <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Industry not elsewhere specified", "Industry not‚Ä¶</span></span>
<span><span class="co">#&gt; $ Product              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Electricity", "Fuel oil", "Gas/diesel oil excl. ‚Ä¶</span></span>
<span><span class="co">#&gt; $ Unit                 <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "TJ", "TJ", "TJ", "TJ", "TJ", "TJ", "TJ", "TJ", "‚Ä¶</span></span>
<span><span class="co">#&gt; $ Edot                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 918.0020, 3698.4014, 1645.3998, 6100.0001, 698.40‚Ä¶</span></span></code></pre></div>
<p>The next step is to develop a blank template in which the analyst can
provide final-to-useful allocation values (<code>C</code>) in
percentages. <code><a href="../reference/fu_allocation_template.html">fu_allocation_template()</a></code> builds a
final-to-useful allocation template.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">FU_allocation_template</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_tidy_iea_df.html">load_tidy_iea_df</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/specify_all.html">specify_all</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/fu_allocation_template.html">fu_allocation_template</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">FU_allocation_template</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 906</span></span>
<span><span class="co">#&gt; Columns: 15</span></span>
<span><span class="co">#&gt; $ Country              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "GHA", "GHA", "GHA", "GHA", "GHA", "GHA", "GHA", ‚Ä¶</span></span>
<span><span class="co">#&gt; $ Method               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "PCM", "PCM", "PCM", "PCM", "PCM", "PCM", "PCM", ‚Ä¶</span></span>
<span><span class="co">#&gt; $ EnergyType           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "E", "E", "E", "E", "E", "E", "E", "E", "E", "E",‚Ä¶</span></span>
<span><span class="co">#&gt; $ LastStage            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Final", "Final", "Final", "Final", "Final", "Fin‚Ä¶</span></span>
<span><span class="co">#&gt; $ LedgerSide           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Supply", "Supply", "Supply", "Supply", "Supply",‚Ä¶</span></span>
<span><span class="co">#&gt; $ FlowAggregationPoint <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Energy industry own use", "Energy industry own u‚Ä¶</span></span>
<span><span class="co">#&gt; $ Unit                 <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "TJ", "TJ", "TJ", "TJ", "TJ", "TJ", "TJ", "TJ", "‚Ä¶</span></span>
<span><span class="co">#&gt; $ EfProduct            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Refinery gas", "Refinery gas", "Refinery gas", "‚Ä¶</span></span>
<span><span class="co">#&gt; $ Machine              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N‚Ä¶</span></span>
<span><span class="co">#&gt; $ EuProduct            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N‚Ä¶</span></span>
<span><span class="co">#&gt; $ Destination          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Oil refineries", "Oil refineries", "Oil refineri‚Ä¶</span></span>
<span><span class="co">#&gt; $ Quantity             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Edot", "Edot [%]", "C_1 [%]", "C_2 [%]", "C_3 [%‚Ä¶</span></span>
<span><span class="co">#&gt; $ MaximumValues        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1.106299e+03, 8.867781e-01, NA, NA, NA, NA, 1.583‚Ä¶</span></span>
<span><span class="co">#&gt; $ `1971`               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 8.176988e+02, 8.867781e-01, NA, NA, NA, NA, 1.044‚Ä¶</span></span>
<span><span class="co">#&gt; $ `2000`               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1106.2991000, 0.8747534, NA, NA, NA, NA, 158.3992‚Ä¶</span></span></code></pre></div>
<p>To obtain a nicely-formatted Excel spreadsheet, use the
<code><a href="../reference/write_fu_allocation_template.html">write_fu_allocation_template()</a></code> function.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># FU_allocation_template %&gt;%</span></span>
<span><span class="co">#   write_fu_allocation_template("~/Desktop/Test_FU_allocation_template.xlsx")</span></span></code></pre></div>
<p>The analyst should complete all of the unshaded cells in the
<code>Machine</code> and <code>Eu.product</code> columns.
<code>Machine</code> should contain names of final-to-useful machines
such as ‚ÄúAutomobiles,‚Äù ‚ÄúIndustrial heat/furnace,‚Äù etc.
<code>Eu.product</code> should be filled with names of useful energy
carriers such as ‚ÄúHTH.600.C‚Äù, ‚ÄúMD‚Äù, or ‚ÄúLight‚Äù. Note that later
processing will parse the heat categories for their temperature, and the
required format is <code>*TH.nnn.U</code>, where</p>
<ul>
<li>
<code>*</code> (the first character) is arbitrary, but
<code>H</code>, <code>M</code>, and <code>L</code> are typical for high,
medium, and low temperature heat, respectively,</li>
<li>
<code>TH.</code> is required,</li>
<li>
<code>nnn</code> can be any number of digits, optionally preceded by
a negative sign,</li>
<li>
<code>.</code> is required, and</li>
<li>
<code>U</code> is the temperature unit, one of <code>C</code>,
<code>F</code>, <code>R</code>, or <code>K</code> for degrees Celsius,
degrees Fahrenheit, rankine, or kelvin, respectively.</li>
</ul>
<p>The <code>C</code> rows representation allocations of
<code>Edot</code> energy to final-to-useful machines for each year of
available IEA data. Three allocation rows (<code>C_1 [%]</code>,
<code>C_2 [%]</code>, and <code>C_3 [%]</code>) are provided for each
combination of <code>Flow.aggregation.point</code>,
<code>Ef.product</code>, and <code>Destination</code>. Not all
<code>C_i [%]</code> rows need to be filled, and the analyst can add
more allocation rows (<code>C_4 [%]</code>, <code>C_5 [%]</code>, ‚Ä¶) as
required.</p>
<p>The rows are in IEA order for <code>Flow.aggregation.point</code>,
<code>Ef.product</code>, and <code>Destination</code>.</p>
<p>The <code>Maximum.values</code> column provides an indication of
which <code>Destination</code>s receive more energy than others,
allowing the analyst to focus more attention on larger energy flows, as
desired.</p>
</div>
<div class="section level2">
<h2 id="final-to-useful-efficiencies-and-useful-exergy-to-energy-ratios">Final-to-useful efficiencies and useful exergy-to-energy ratios<a class="anchor" aria-label="anchor" href="#final-to-useful-efficiencies-and-useful-exergy-to-energy-ratios"></a>
</h2>
<p>After completing the final-to-useful allocation table, the analyst
must specify the efficiencies of the final-to-useful machines. To assist
with this task, the <code><a href="../reference/eta_fu_template.html">eta_fu_template()</a></code> function can be
invoked. To demonstrate, we‚Äôll use
<code><a href="../reference/load_fu_allocation_data.html">load_fu_allocation_data()</a></code>, a function that reads a
completed allocation table out of an excel file. The default
<code>path</code> argument of <code><a href="../reference/load_fu_allocation_data.html">load_fu_allocation_data()</a></code>
points to a completed final-to-useful allocation table that is provided
with <code>IEATools</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Eta_fu_template</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_fu_allocation_data.html">load_fu_allocation_data</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/eta_fu_template.html">eta_fu_template</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">Eta_fu_template</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 276</span></span>
<span><span class="co">#&gt; Columns: 11</span></span>
<span><span class="co">#&gt; $ Country       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "GHA", "GHA", "GHA", "GHA", "GHA", "GHA", "GHA", "GHA", ‚Ä¶</span></span>
<span><span class="co">#&gt; $ Method        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "PCM", "PCM", "PCM", "PCM", "PCM", "PCM", "PCM", "PCM", ‚Ä¶</span></span>
<span><span class="co">#&gt; $ EnergyType    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "‚Ä¶</span></span>
<span><span class="co">#&gt; $ LastStage     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Final", "Final", "Final", "Final", "Final", "Final", "F‚Ä¶</span></span>
<span><span class="co">#&gt; $ Unit          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "ktoe", "ktoe", "ktoe", "ktoe", "ktoe", "ktoe", "ktoe", ‚Ä¶</span></span>
<span><span class="co">#&gt; $ Machine       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Automobiles", "Automobiles", "Automobiles", "Automobile‚Ä¶</span></span>
<span><span class="co">#&gt; $ EuProduct     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "MD", "MD", "MD", "MD", "MD", "MD", "MD", "MD", "MD", "M‚Ä¶</span></span>
<span><span class="co">#&gt; $ Quantity      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Edot_machine", "Edot_machine [%]", "etafu", "phiu", "Ed‚Ä¶</span></span>
<span><span class="co">#&gt; $ MaximumValues <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 6.192510e+02, 1.141842e-01, NA, NA, 1.877078e+02, 3.4611‚Ä¶</span></span>
<span><span class="co">#&gt; $ `1971`        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2.172315e+02, 8.333158e-02, NA, 1.000000e+00, 5.946665e+‚Ä¶</span></span>
<span><span class="co">#&gt; $ `2000`        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 6.192510e+02, 1.141842e-01, NA, 1.000000e+00, 1.877078e+‚Ä¶</span></span></code></pre></div>
<p>To obtain a nicely-formatted Excel spreadsheet, use the
<code><a href="../reference/write_fu_allocation_template.html">write_fu_allocation_template()</a></code> function.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Eta_fu_template %&gt;%</span></span>
<span><span class="co">#   write_eta_fu_template("~/Desktop/Test_eta_fu_template.xlsx")</span></span></code></pre></div>
<p>The analyst should fill all unshaded cells in <code>eta.fu</code>
rows with final-to-useful energy efficiency values (in %).
<code>phi.u</code> rows should be completed with exergy-to-energy ratios
for the useful stage energy carrier. Note that many <code>phi.u</code>
values are already filled for cases where the phi value is known or
easily calculable, specifically mechanical drive (phi = 1) and heat (phi
= 1 - T_0/T_H, where T_H is the heat temperature embedded in the
<code>*TH.nnn.U</code> useful exergy string).</p>
<p>The <code>Maximum.values</code> column provides an indication of
which <code>Destination</code>s receive more energy than others,
allowing the analyst to focus more attention on larger energy flows, as
desired. The <code>Edot_machine</code> and <code>Edot_machine [%]</code>
rows indicate energy flows and percentages into each final-to-useful
machine in each year.</p>
<p>After allocations and efficiencies are specified (by completing the
templates), functions can be used to move the last stage of an energy
conversion chain from final energy to useful energy.</p>
</div>
<div class="section level2">
<h2 id="allocation-c-matrices">Allocation (C) matrices<a class="anchor" aria-label="anchor" href="#allocation-c-matrices"></a>
</h2>
<p>Next, the <code>C</code> values from the allocation table must be
arranged into
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùêÇ</mi><annotation encoding="application/x-tex">\mathbf{C}</annotation></semantics></math>
matrices using the <code><a href="../reference/form_C_mats.html">form_C_mats()</a></code> function.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">C_mats</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_fu_allocation_data.html">load_fu_allocation_data</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/form_C_mats.html">form_C_mats</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">C_mats</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 4</span></span>
<span><span class="co">#&gt; Columns: 7</span></span>
<span><span class="co">#&gt; $ Country    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "GHA", "GHA", "ZAF", "ZAF"</span></span>
<span><span class="co">#&gt; $ Method     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "PCM", "PCM", "PCM", "PCM"</span></span>
<span><span class="co">#&gt; $ EnergyType <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "E", "E", "E", "E"</span></span>
<span><span class="co">#&gt; $ LastStage  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Final", "Final", "Final", "Final"</span></span>
<span><span class="co">#&gt; $ Year       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1971, 2000, 1971, 2000</span></span>
<span><span class="co">#&gt; $ C_EIOU     <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[2 x 3]&gt;&gt;, &lt;&lt;matrix[2 x 3]&gt;&gt;, &lt;&lt;matrix[3 x 3]&gt;&gt;, &lt;&lt;‚Ä¶</span></span>
<span><span class="co">#&gt; $ C_Y        <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[23 x 21]&gt;&gt;, &lt;&lt;matrix[24 x 20]&gt;&gt;, &lt;&lt;matrix[45 x 30]‚Ä¶</span></span></code></pre></div>
<p>Note that two types of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùêÇ</mi><annotation encoding="application/x-tex">\mathbf{C}</annotation></semantics></math>
matrices are formed,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ùêÇ</mi><mrow><mi>E</mi><mi>I</mi><mi>O</mi><mi>U</mi></mrow></msub><annotation encoding="application/x-tex">\mathbf{C}_{EIOU}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ùêÇ</mi><mi>Y</mi></msub><annotation encoding="application/x-tex">\mathbf{C}_Y</annotation></semantics></math>.
Both are needed later.</p>
</div>
<div class="section level2">
<h2 id="efficiency-and-exergy-to-energy-ratio-vectors">Efficiency and exergy-to-energy ratio vectors<a class="anchor" aria-label="anchor" href="#efficiency-and-exergy-to-energy-ratio-vectors"></a>
</h2>
<p>Next, vectors containing final-to-useful energy efficiencies
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ùõà</mi><mrow><mi>f</mi><mi>u</mi></mrow></msub><annotation encoding="application/x-tex">\mathbf{\eta}_{fu}</annotation></semantics></math>)
and exergy-to-energy ratios
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùõü</mi><annotation encoding="application/x-tex">\mathbf{\phi}</annotation></semantics></math>)
must be formed using the <code><a href="../reference/form_eta_fu_phi_u_vecs.html">form_eta_fu_phi_u_vecs()</a></code>
function.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eta_fu_vecs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_eta_fu_data.html">load_eta_fu_data</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/form_eta_fu_phi_u_vecs.html">form_eta_fu_phi_u_vecs</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">eta_fu_vecs</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 4</span></span>
<span><span class="co">#&gt; Columns: 7</span></span>
<span><span class="co">#&gt; $ Country    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "GHA", "GHA", "ZAF", "ZAF"</span></span>
<span><span class="co">#&gt; $ Method     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "PCM", "PCM", "PCM", "PCM"</span></span>
<span><span class="co">#&gt; $ EnergyType <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "E", "E", "E", "E"</span></span>
<span><span class="co">#&gt; $ LastStage  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Final", "Final", "Final", "Final"</span></span>
<span><span class="co">#&gt; $ Year       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1971, 2000, 1971, 2000</span></span>
<span><span class="co">#&gt; $ etafu      <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[22 x 1]&gt;&gt;, &lt;&lt;matrix[21 x 1]&gt;&gt;, &lt;&lt;matrix[31 x 1]&gt;&gt;,‚Ä¶</span></span>
<span><span class="co">#&gt; $ phiu       <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[6 x 1]&gt;&gt;, &lt;&lt;matrix[6 x 1]&gt;&gt;, &lt;&lt;matrix[7 x 1]&gt;&gt;, &lt;&lt;‚Ä¶</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="extend-to-useful">Extend to useful<a class="anchor" aria-label="anchor" href="#extend-to-useful"></a>
</h2>
<p>To extend an energy conversion chain (ECC) to the useful stage, first
convert the IEA data into physical supply-use table format with final
energy being the last stage of the energy conversion chain. Thereafter,
join the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùêÇ</mi><annotation encoding="application/x-tex">\mathbf{C}</annotation></semantics></math>
matrices and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ùõà</mi><mrow><mi>ùêü</mi><mi>ùêÆ</mi></mrow></msub><annotation encoding="application/x-tex">\mathbf{\eta_{fu}}</annotation></semantics></math>
vectors to the data frame of PSUT matrices.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get a list of the metadata columns.</span></span>
<span><span class="co"># This list will be the same for C_mats.</span></span>
<span><span class="va">m_cols</span> <span class="op">&lt;-</span> <span class="va">eta_fu_vecs</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/meta_cols.html">meta_cols</a></span><span class="op">(</span>return_names <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            years_to_keep <span class="op">=</span> <span class="fu">IEATools</span><span class="fu">::</span><span class="va"><a href="../reference/iea_cols.html">iea_cols</a></span><span class="op">$</span><span class="va">year</span>,</span>
<span>            not_meta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">IEATools</span><span class="fu">::</span><span class="va"><a href="../reference/template_cols.html">template_cols</a></span><span class="op">$</span><span class="va">eta_fu</span>, <span class="fu">IEATools</span><span class="fu">::</span><span class="va"><a href="../reference/template_cols.html">template_cols</a></span><span class="op">$</span><span class="va">phi_u</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">m_cols</span></span>
<span><span class="co">#&gt; [1] "Country"    "Method"     "EnergyType" "LastStage"  "Year"</span></span>
<span><span class="va">psut_mats_final</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_tidy_iea_df.html">load_tidy_iea_df</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/specify_all.html">specify_all</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/prep_psut.html">prep_psut</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">C_mats</span>, by <span class="op">=</span> <span class="va">m_cols</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">eta_fu_vecs</span>, by <span class="op">=</span> <span class="va">m_cols</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">psut_mats_final</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 4</span></span>
<span><span class="co">#&gt; Columns: 17</span></span>
<span><span class="co">#&gt; $ Country    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "GHA", "GHA", "ZAF", "ZAF"</span></span>
<span><span class="co">#&gt; $ Method     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "PCM", "PCM", "PCM", "PCM"</span></span>
<span><span class="co">#&gt; $ EnergyType <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "E", "E", "E", "E"</span></span>
<span><span class="co">#&gt; $ LastStage  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Final", "Final", "Final", "Final"</span></span>
<span><span class="co">#&gt; $ Year       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1971, 2000, 1971, 2000</span></span>
<span><span class="co">#&gt; $ Y          <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 21]&gt;&gt;, &lt;&lt;matrix[13 x 20]&gt;&gt;, &lt;&lt;matrix[18 x 26]‚Ä¶</span></span>
<span><span class="co">#&gt; $ S_units    <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[16 x 1]&gt;&gt;, &lt;&lt;matrix[18 x 1]&gt;&gt;, &lt;&lt;matrix[24 x 1]&gt;&gt;,‚Ä¶</span></span>
<span><span class="co">#&gt; $ R          <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 8]&gt;&gt;, &lt;&lt;matrix[13 x 12]&gt;&gt;, &lt;&lt;matrix[6 x 6]&gt;&gt;, ‚Ä¶</span></span>
<span><span class="co">#&gt; $ U          <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[8 x 5]&gt;&gt;, &lt;&lt;matrix[7 x 5]&gt;&gt;, &lt;&lt;matrix[11 x 11]&gt;&gt;, ‚Ä¶</span></span>
<span><span class="co">#&gt; $ U_feed     <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[6 x 5]&gt;&gt;, &lt;&lt;matrix[5 x 5]&gt;&gt;, &lt;&lt;matrix[9 x 11]&gt;&gt;, &lt;‚Ä¶</span></span>
<span><span class="co">#&gt; $ U_EIOU     <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[2 x 2]&gt;&gt;, &lt;&lt;matrix[2 x 2]&gt;&gt;, &lt;&lt;matrix[2 x 3]&gt;&gt;, &lt;‚Ä¶</span></span>
<span><span class="co">#&gt; $ r_EIOU     <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[8 x 5]&gt;&gt;, &lt;&lt;matrix[7 x 5]&gt;&gt;, &lt;&lt;matrix[11 x 11]&gt;&gt;,‚Ä¶</span></span>
<span><span class="co">#&gt; $ V          <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[5 x 11]&gt;&gt;, &lt;&lt;matrix[5 x 11]&gt;&gt;, &lt;&lt;matrix[11 x 20]&gt;‚Ä¶</span></span>
<span><span class="co">#&gt; $ C_EIOU     <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[2 x 3]&gt;&gt;, &lt;&lt;matrix[2 x 3]&gt;&gt;, &lt;&lt;matrix[3 x 3]&gt;&gt;, &lt;‚Ä¶</span></span>
<span><span class="co">#&gt; $ C_Y        <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[23 x 21]&gt;&gt;, &lt;&lt;matrix[24 x 20]&gt;&gt;, &lt;&lt;matrix[45 x 30‚Ä¶</span></span>
<span><span class="co">#&gt; $ etafu      <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[22 x 1]&gt;&gt;, &lt;&lt;matrix[21 x 1]&gt;&gt;, &lt;&lt;matrix[31 x 1]&gt;&gt;‚Ä¶</span></span>
<span><span class="co">#&gt; $ phiu       <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[6 x 1]&gt;&gt;, &lt;&lt;matrix[6 x 1]&gt;&gt;, &lt;&lt;matrix[7 x 1]&gt;&gt;, &lt;‚Ä¶</span></span></code></pre></div>
<p>Then use the allocation and efficiency matrices to extend to the
useful stage with the <code><a href="../reference/extend_to_useful.html">extend_to_useful()</a></code> function.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">psut_mats_useful</span> <span class="op">&lt;-</span> <span class="va">psut_mats_final</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/extend_to_useful.html">extend_to_useful</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">psut_mats_useful</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/stack_final_useful_df.html">stack_final_useful_df</a></span><span class="op">(</span><span class="va">psut_mats_useful</span>, <span class="va">psut_mats_final</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">psut_mats_useful</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 8</span></span>
<span><span class="co">#&gt; Columns: 15</span></span>
<span><span class="co">#&gt; $ Country           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "GHA", "GHA", "ZAF", "ZAF", "GHA", "GHA", "ZAF", "ZA‚Ä¶</span></span>
<span><span class="co">#&gt; $ Method            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "PCM", "PCM", "PCM", "PCM", "PCM", "PCM", "PCM", "PC‚Ä¶</span></span>
<span><span class="co">#&gt; $ EnergyType        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "E", "E", "E", "E", "E", "E", "E", "E"</span></span>
<span><span class="co">#&gt; $ LastStage         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Final", "Final", "Final", "Final", "Useful", "Usefu‚Ä¶</span></span>
<span><span class="co">#&gt; $ Year              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1971, 2000, 1971, 2000, 1971, 2000, 1971, 2000</span></span>
<span><span class="co">#&gt; $ Y                 <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 21]&gt;&gt;, &lt;&lt;matrix[13 x 20]&gt;&gt;, &lt;&lt;matrix[1‚Ä¶</span></span>
<span><span class="co">#&gt; $ S_units           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[16 x 1]&gt;&gt;, &lt;&lt;matrix[18 x 1]&gt;&gt;, &lt;&lt;matrix[24 ‚Ä¶</span></span>
<span><span class="co">#&gt; $ R                 <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 8]&gt;&gt;, &lt;&lt;matrix[13 x 12]&gt;&gt;, &lt;&lt;matrix[6 ‚Ä¶</span></span>
<span><span class="co">#&gt; $ U                 <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[8 x 5]&gt;&gt;, &lt;&lt;matrix[7 x 5]&gt;&gt;, &lt;&lt;matrix[11 x‚Ä¶</span></span>
<span><span class="co">#&gt; $ U_feed            <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[6 x 5]&gt;&gt;, &lt;&lt;matrix[5 x 5]&gt;&gt;, &lt;&lt;matrix[9 x ‚Ä¶</span></span>
<span><span class="co">#&gt; $ U_EIOU            <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[2 x 2]&gt;&gt;, &lt;&lt;matrix[2 x 2]&gt;&gt;, &lt;&lt;matrix[2 x ‚Ä¶</span></span>
<span><span class="co">#&gt; $ r_EIOU            <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[8 x 5]&gt;&gt;, &lt;&lt;matrix[7 x 5]&gt;&gt;, &lt;&lt;matrix[11 x‚Ä¶</span></span>
<span><span class="co">#&gt; $ V                 <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[5 x 11]&gt;&gt;, &lt;&lt;matrix[5 x 11]&gt;&gt;, &lt;&lt;matrix[11‚Ä¶</span></span>
<span><span class="co">#&gt; $ Y_fu_details      <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;&lt;matrix[23 x 21]&gt;&gt;‚Ä¶</span></span>
<span><span class="co">#&gt; $ U_EIOU_fu_details <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;&lt;matrix[2 x 3]&gt;&gt;, ‚Ä¶</span></span></code></pre></div>
<p>Notice that several additional rows have been created in the data
frame. The additional rows contain versions of ECC matrices wherein the
last stage of the ECC is useful energy. Extending to the useful stage
means many additional energy products are included in the energy
conversion chain. For example, the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùêò</mi><annotation encoding="application/x-tex">\mathbf{Y}</annotation></semantics></math>
matrix includes additional rows for mechanical drive (MD), heat
(MTH.100.C, e.g.), and light.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># A Y matrix where final energy is the last stage of the energy conversion chain</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">psut_mats_useful</span><span class="op">$</span><span class="va">Y</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "Aviation gasoline"                    </span></span>
<span><span class="co">#&gt;  [2] "Charcoal"                             </span></span>
<span><span class="co">#&gt;  [3] "Crude oil"                            </span></span>
<span><span class="co">#&gt;  [4] "Electricity"                          </span></span>
<span><span class="co">#&gt;  [5] "Fuel oil"                             </span></span>
<span><span class="co">#&gt;  [6] "Gas/diesel oil excl. biofuels"        </span></span>
<span><span class="co">#&gt;  [7] "Kerosene type jet fuel excl. biofuels"</span></span>
<span><span class="co">#&gt;  [8] "Liquefied petroleum gases (LPG)"      </span></span>
<span><span class="co">#&gt;  [9] "Lubricants"                           </span></span>
<span><span class="co">#&gt; [10] "Motor gasoline excl. biofuels"        </span></span>
<span><span class="co">#&gt; [11] "Other kerosene"                       </span></span>
<span><span class="co">#&gt; [12] "Primary solid biofuels"</span></span>
<span></span>
<span><span class="co"># A Y matrix where useful energy is the last stage of the energy conversion chain</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">psut_mats_useful</span><span class="op">$</span><span class="va">Y</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "Aviation gasoline"                    </span></span>
<span><span class="co">#&gt;  [2] "Charcoal"                             </span></span>
<span><span class="co">#&gt;  [3] "Crude oil"                            </span></span>
<span><span class="co">#&gt;  [4] "Electricity"                          </span></span>
<span><span class="co">#&gt;  [5] "Fuel oil"                             </span></span>
<span><span class="co">#&gt;  [6] "Gas/diesel oil excl. biofuels"        </span></span>
<span><span class="co">#&gt;  [7] "HTH.600.C [from Electric heaters]"    </span></span>
<span><span class="co">#&gt;  [8] "Kerosene type jet fuel excl. biofuels"</span></span>
<span><span class="co">#&gt;  [9] "Light [from Electric lights]"         </span></span>
<span><span class="co">#&gt; [10] "Liquefied petroleum gases (LPG)"      </span></span>
<span><span class="co">#&gt; [11] "Lubricants"                           </span></span>
<span><span class="co">#&gt; [12] "MD [from Automobiles]"                </span></span>
<span><span class="co">#&gt; [13] "MD [from Boat engines]"               </span></span>
<span><span class="co">#&gt; [14] "MD [from Diesel cars]"                </span></span>
<span><span class="co">#&gt; [15] "MD [from Diesel trains]"              </span></span>
<span><span class="co">#&gt; [16] "MD [from Diesel trucks]"              </span></span>
<span><span class="co">#&gt; [17] "MD [from Electric motors]"            </span></span>
<span><span class="co">#&gt; [18] "MD [from Fans]"                       </span></span>
<span><span class="co">#&gt; [19] "MD [from Trucks]"                     </span></span>
<span><span class="co">#&gt; [20] "Motor gasoline excl. biofuels"        </span></span>
<span><span class="co">#&gt; [21] "MTH.100.C [from Charcoal stoves]"     </span></span>
<span><span class="co">#&gt; [22] "MTH.100.C [from Electric stoves]"     </span></span>
<span><span class="co">#&gt; [23] "MTH.100.C [from Kerosene stoves]"     </span></span>
<span><span class="co">#&gt; [24] "MTH.100.C [from LPG stoves]"          </span></span>
<span><span class="co">#&gt; [25] "MTH.100.C [from Wood cookstoves]"     </span></span>
<span><span class="co">#&gt; [26] "MTH.200.C [from Electric heaters]"    </span></span>
<span><span class="co">#&gt; [27] "MTH.200.C [from Electric stoves]"     </span></span>
<span><span class="co">#&gt; [28] "MTH.200.C [from Industrial furnaces]" </span></span>
<span><span class="co">#&gt; [29] "MTH.200.C [from Irons]"               </span></span>
<span><span class="co">#&gt; [30] "MTH.200.C [from Wood stoves]"         </span></span>
<span><span class="co">#&gt; [31] "NEU [from Non-energy consumption]"    </span></span>
<span><span class="co">#&gt; [32] "Other kerosene"                       </span></span>
<span><span class="co">#&gt; [33] "Primary solid biofuels"</span></span></code></pre></div>
<!-- It would be nice to calculate the energy balance of all rows of the data frame here,
     showing that extending to the useful stage does not affect the energy balance of the ECC
     when done correctly.  
     Unfortunately, the function to perform those energy balances resides in the Recca package. 
     By design, IEATools cannot depend on Recca. -->
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>The process of moving from final energy to useful energy as the last
stage of an energy conversion chain is aided by several functions in the
<code>IEATools</code> package. In particular,</p>
<ul>
<li>
<code><a href="../reference/prep_psut.html">prep_psut()</a></code>,</li>
<li>
<code><a href="../reference/form_C_mats.html">form_C_mats()</a></code>,</li>
<li>
<code><a href="../reference/form_eta_fu_phi_u_vecs.html">form_eta_fu_phi_u_vecs()</a></code>, and</li>
<li><code><a href="../reference/extend_to_useful.html">extend_to_useful()</a></code></li>
</ul>
<p>provide a convenient workflow for that process.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matthew Kuperus Heun, Emmanuel Aramendia, Zeke Marshall.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>

<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Find transformation sinks and sources — tp_sinks_sources • IEATools</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Find transformation sinks and sources — tp_sinks_sources" />
<meta property="og:description" content="In the IEA extended energy balance data,
transformation processes (tp) ought to both consume and produce energy.
But some transformation processes consume energy without producing any energy;
others produce without consuming.
Such transformation processes can be called &quot;transformation sinks&quot; and
&quot;transformation sources,&quot; respectively.
This function finds and identifies transformation processes that act as sinks or sources." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">IEATools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.19</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/IEATools.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/final_to_useful.html">Final to Useful Analysis</a>
    </li>
    <li>
      <a href="../articles/fix_iea_data.html">Fixes for IEA Data</a>
    </li>
    <li>
      <a href="../articles/prep_psut.html">Prepare for PSUT analysis</a>
    </li>
    <li>
      <a href="../articles/specify.html">Specify EIOU Industries and Flows</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Find transformation sinks and sources</h1>
    
    <div class="hidden name"><code>tp_sinks_sources.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>In the IEA extended energy balance data,
transformation processes (tp) ought to both consume and produce energy.
But some transformation processes consume energy without producing any energy;
others produce without consuming.
Such transformation processes can be called "transformation sinks" and
"transformation sources," respectively.
This function finds and identifies transformation processes that act as sinks or sources.</p>
    </div>

    <pre class="usage"><span class='fu'>tp_sinks_sources</span>(
  <span class='no'>.tidy_iea_df</span>,
  <span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"sinks"</span>, <span class='st'>"sources"</span>),
  <span class='kw'>flow_aggregation_point</span> <span class='kw'>=</span> <span class='st'>"Flow.aggregation.point"</span>,
  <span class='kw'>transformation_processes</span> <span class='kw'>=</span> <span class='st'>"Transformation processes"</span>,
  <span class='kw'>eiou</span> <span class='kw'>=</span> <span class='st'>"Energy industry own use"</span>,
  <span class='kw'>flow</span> <span class='kw'>=</span> <span class='st'>"Flow"</span>,
  <span class='kw'>product</span> <span class='kw'>=</span> <span class='st'>"Product"</span>,
  <span class='kw'>e_dot</span> <span class='kw'>=</span> <span class='st'>"E.dot"</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>.tidy_iea_df</th>
      <td><p>a tidy data frame containing IEA extended energy balance data</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>one of "sinks" or "sources"</p></td>
    </tr>
    <tr>
      <th>flow_aggregation_point</th>
      <td><p>the name of the flow aggregation point column in <code>.tidy_iea_df</code>. Default is "<code>Flow.aggregation.point</code>".</p></td>
    </tr>
    <tr>
      <th>transformation_processes</th>
      <td><p>a string that identifies transformation processes in the <code>flow_aggregation_point</code> column. Default is "<code>Transformation processes</code>".</p></td>
    </tr>
    <tr>
      <th>eiou</th>
      <td><p>a string that identifies energy industry own use in the <code>flow_aggregation_point</code> column. Default is "<code>Energy industry own use</code>".</p></td>
    </tr>
    <tr>
      <th>flow</th>
      <td><p>the name of the flow column in <code>.tidy_iea_df</code>. Default is "<code>Flow</code>".</p></td>
    </tr>
    <tr>
      <th>product</th>
      <td><p>the name of the product column in <code>.tidy_iea_df</code>. Default is "<code>Product</code>".</p></td>
    </tr>
    <tr>
      <th>e_dot</th>
      <td><p>the name of the energy rate column in <code>.tidy_iea_df</code>. Default is "<code>E.dot</code>".</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>the <code>grouping_vars</code> and the <code>flow</code> column,
with one row for each industry that is a transformation sink or source.
Industries that are transformation sinks or sources are named in the <code>flow</code> column.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>It is important to identify transformation sinks,
because they cause two problems for physical supply-use table (PSUT) analysis.
First, when swimming upstream, a PSUT analysis cannot "see" the sunk energy carriers,
because they have no downstream effects.
Thus, upstream swims cannot conserve energy.
Second, when calculating embodied energy for each downstream energy carrier,
the sunk energy carriers cannot be embodied in any final demand energy carriers.
Thus, embodied energy calculations cannot conserve energy.</p>
<p>Transformation sources can also cause problems for physical supply-use table (PSUT) analysis.
In particular, when swimming upstream, a PSUT analysis will "see" the final energy sources,
but cannot see any associated primary energy carriers.</p>
<p>Transformation sinks and sources are identified by the following algorithm:</p><ol>
<li><p>Identify (per group in <code>.tidy_iea_df</code>) all <code>Transformation processes</code> that consume energy (negative value for <code>E.dot</code>).
Energy consumption can be for the transformation process itself or for Energy industry own use.</p></li>
<li><p>Identify (per group in <code>.tidy_iea_df</code>) all <code>Transformation processes</code> that produce energy (positive value for <code>E.dot</code>).</p></li>
<li><p>Take the set difference between the two (consumers less producers for sinks and producers less consumers for sources).
The set difference is the list of transformation sinks or sources, respectively.</p></li>
</ol>

<p><code>tp_sinks_sources()</code> is a function not unlike <code><a href='https://dplyr.tidyverse.org/reference/summarise.html'>dplyr::summarise()</a></code>;
it returns a summary containing grouping variables and industries that are transformation sinks or sources.
So be sure to specify (or accept defaults for)
the <code>grouping_vars</code> argument.
Typical grouping variables are <code>Method</code>, <code>Last.stage</code>, <code>Country</code>, <code>Year</code>, <code>Energy.type</code>.
Don't group on <code>Flow.aggregation.point</code>, because energy from different aggregation points
(<code>Energy industry own use</code> and <code>Transformation processes</code>) flows into each machine.
Don't group on <code>Flow</code>, <code>Product</code>, or <code>E.dot</code>, either.
If groups are not set,
<code>flow</code>s will be analyzed together, possibly leading to missed transformation sinks or sources.</p>
<p>The various <code>specify_*()</code> functions should also be called <em>before</em> calling <code>tp_sinks_sources()</code>.
The <code>specify_*()</code> functions clean up the IEA data, ensuring that energy is routed to the right places.</p>
<p>Note that this function only identifies transformation sinks or sources;
it does not fix the problem.
To solve the problem of transformation sinks,
see the <code><a href='tp_sinks_to_nonenergy.html'>tp_sinks_to_nonenergy()</a></code> function.
<code><a href='tp_sinks_to_nonenergy.html'>tp_sinks_to_nonenergy()</a></code> uses the output of <code>tp_sinks_sources()</code>
to route energy consumed by transformation sinks to <code>Non-energy use industry/transformation/energy</code>.
There is no function to solve the problem of transformation sources at this time.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>dplyr</span>)
<span class='fu'><a href='load_tidy_iea_df.html'>load_tidy_iea_df</a></span>() <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='specify_primary_production.html'>specify_primary_production</a></span>() <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='specify_interface_industries.html'>specify_interface_industries</a></span>() <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='specify_tp_eiou.html'>specify_tp_eiou</a></span>() <span class='kw'>%&gt;%</span>
  <span class='fu'>tp_sinks_sources</span>()</div><div class='output co'>#&gt; <span style='color: #555555;'># A tibble: 0 x 8</span><span>
#&gt; </span><span style='color: #555555;'># … with 8 variables: Country </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span style='color: #555555;'>, Method </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span style='color: #555555;'>, Energy.type </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span style='color: #555555;'>,</span><span>
#&gt; </span><span style='color: #555555;'>#   Last.stage </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span style='color: #555555;'>, Year </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>, Ledger.side </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span style='color: #555555;'>, Unit </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span style='color: #555555;'>, Flow </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span></div><div class='input'><span class='fu'><a href='load_tidy_iea_df.html'>load_tidy_iea_df</a></span>() <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='specify_primary_production.html'>specify_primary_production</a></span>() <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='specify_interface_industries.html'>specify_interface_industries</a></span>() <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='specify_tp_eiou.html'>specify_tp_eiou</a></span>() <span class='kw'>%&gt;%</span>
  <span class='fu'>tp_sinks_sources</span>(<span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"sources"</span>)</div><div class='output co'>#&gt; </span><span style='color: #555555;'># A tibble: 0 x 8</span><span>
#&gt; </span><span style='color: #555555;'># … with 8 variables: Country </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span style='color: #555555;'>, Method </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span style='color: #555555;'>, Energy.type </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span style='color: #555555;'>,</span><span>
#&gt; </span><span style='color: #555555;'>#   Last.stage </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span style='color: #555555;'>, Year </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>, Ledger.side </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span style='color: #555555;'>, Unit </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span style='color: #555555;'>, Flow </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span></div></span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Matthew Heun.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.0.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>



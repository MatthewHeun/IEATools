<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content='In the IEA extended energy balance data,
transformation processes (tp) ought to both consume and produce energy.
But some transformation processes consume energy without producing any energy;
others produce without consuming.
Such transformation processes can be called "transformation sinks" and
"transformation sources," respectively.
This function finds and identifies transformation processes that act as sinks or sources.'><title>Find transformation sinks and sources — tp_sinks_sources • IEATools</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Find transformation sinks and sources — tp_sinks_sources"><meta property="og:description" content='In the IEA extended energy balance data,
transformation processes (tp) ought to both consume and produce energy.
But some transformation processes consume energy without producing any energy;
others produce without consuming.
Such transformation processes can be called "transformation sinks" and
"transformation sources," respectively.
This function finds and identifies transformation processes that act as sinks or sources.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">IEATools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.68</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/IEATools.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/final_to_useful.html">Final to Useful Analysis</a>
    <a class="dropdown-item" href="../articles/fix_iea_data.html">Fixes for IEA Data</a>
    <a class="dropdown-item" href="../articles/prep_psut.html">Prepare for PSUT analysis</a>
    <a class="dropdown-item" href="../articles/psut_names.html">PSUT Names</a>
    <a class="dropdown-item" href="../articles/specify.html">Specify EIOU Industries and Flows</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Find transformation sinks and sources</h1>
      
      <div class="d-none name"><code>tp_sinks_sources.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>In the IEA extended energy balance data,
transformation processes (tp) ought to both consume and produce energy.
But some transformation processes consume energy without producing any energy;
others produce without consuming.
Such transformation processes can be called "transformation sinks" and
"transformation sources," respectively.
This function finds and identifies transformation processes that act as sinks or sources.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">tp_sinks_sources</span><span class="op">(</span></span>
<span>  <span class="va">.tidy_iea_df</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sinks"</span>, <span class="st">"sources"</span><span class="op">)</span>,</span>
<span>  flow_aggregation_point <span class="op">=</span> <span class="st">"Flow.aggregation.point"</span>,</span>
<span>  transformation_processes <span class="op">=</span> <span class="st">"Transformation processes"</span>,</span>
<span>  eiou <span class="op">=</span> <span class="st">"Energy industry own use"</span>,</span>
<span>  flow <span class="op">=</span> <span class="st">"Flow"</span>,</span>
<span>  product <span class="op">=</span> <span class="st">"Product"</span>,</span>
<span>  e_dot <span class="op">=</span> <span class="st">"E.dot"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>.tidy_iea_df</dt>
<dd><p>a tidy data frame containing IEA extended energy balance data</p></dd>


<dt>type</dt>
<dd><p>one of "sinks" or "sources"</p></dd>


<dt>flow_aggregation_point</dt>
<dd><p>the name of the flow aggregation point column in <code>.tidy_iea_df</code>. Default is "<code>Flow.aggregation.point</code>".</p></dd>


<dt>transformation_processes</dt>
<dd><p>a string that identifies transformation processes in the <code>flow_aggregation_point</code> column. Default is "<code>Transformation processes</code>".</p></dd>


<dt>eiou</dt>
<dd><p>a string that identifies energy industry own use in the <code>flow_aggregation_point</code> column. Default is "<code>Energy industry own use</code>".</p></dd>


<dt>flow</dt>
<dd><p>the name of the flow column in <code>.tidy_iea_df</code>. Default is "<code>Flow</code>".</p></dd>


<dt>product</dt>
<dd><p>the name of the product column in <code>.tidy_iea_df</code>. Default is "<code>Product</code>".</p></dd>


<dt>e_dot</dt>
<dd><p>the name of the energy rate column in <code>.tidy_iea_df</code>. Default is "<code>E.dot</code>".</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>The <code>grouping_vars</code> and the <code>flow</code> column,
with one row for each industry that is a transformation sink or source.
Industries that are transformation sinks or sources are named in the <code>flow</code> column.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>It is important to identify transformation sinks,
because they cause two problems for physical supply-use table (PSUT) analysis.
First, when swimming upstream, a PSUT analysis cannot "see" the sunk energy carriers,
because they have no downstream effects.
Thus, upstream swims cannot conserve energy.
Second, when calculating embodied energy for each downstream energy carrier,
the sunk energy carriers cannot be embodied in any final demand energy carriers.
Thus, embodied energy calculations cannot conserve energy.</p>
<p>Transformation sources can also cause problems for physical supply-use table (PSUT) analysis.
In particular, when swimming upstream, a PSUT analysis will "see" the final energy sources,
but cannot see any associated primary energy carriers.</p>
<p>Transformation sinks and sources are identified by the following algorithm:</p><ol><li><p>Identify (per group in <code>.tidy_iea_df</code>) all <code>Transformation processes</code> that consume energy (negative value for <code>E.dot</code>).
Energy consumption can be for the transformation process itself or for Energy industry own use.</p></li>
<li><p>Identify (per group in <code>.tidy_iea_df</code>) all <code>Transformation processes</code> that produce energy (positive value for <code>E.dot</code>).</p></li>
<li><p>Take the set difference between the two (consumers less producers for sinks and producers less consumers for sources).
The set difference is the list of transformation sinks or sources, respectively.</p></li>
</ol><p><code>tp_sinks_sources()</code> is a function not unlike <code><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">dplyr::summarise()</a></code>;
it returns a summary containing grouping variables and industries that are transformation sinks or sources.
So be sure to specify (or accept defaults for)
the <code>grouping_vars</code> argument.
Typical grouping variables are <code>Method</code>, <code>Last.stage</code>, <code>Country</code>, <code>Year</code>, <code>Energy.type</code>.
Don't group on <code>Flow.aggregation.point</code>, because energy from different aggregation points
(<code>Energy industry own use</code> and <code>Transformation processes</code>) flows into each machine.
Don't group on <code>Flow</code>, <code>Product</code>, or <code>E.dot</code>, either.
If groups are not set,
<code>flow</code>s will be analyzed together, possibly leading to missed transformation sinks or sources.</p>
<p>The various <code>specify_*()</code> functions should also be called <em>before</em> calling <code>tp_sinks_sources()</code>.
The <code>specify_*()</code> functions clean up the IEA data, ensuring that energy is routed to the right places.</p>
<p>Note that this function only identifies transformation sinks or sources;
it does not fix the problem.
To solve the problem of transformation sinks,
see the <code><a href="tp_sinks_to_nonenergy.html">tp_sinks_to_nonenergy()</a></code> function.
<code><a href="tp_sinks_to_nonenergy.html">tp_sinks_to_nonenergy()</a></code> uses the output of <code>tp_sinks_sources()</code>
to route energy consumed by transformation sinks to <code>Non-energy use industry/transformation/energy</code>.
There is no function to solve the problem of transformation sources at this time.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="load_tidy_iea_df.html">load_tidy_iea_df</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="specify_primary_production.html">specify_primary_production</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="specify_interface_industries.html">specify_interface_industries</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="specify_tp_eiou.html">specify_tp_eiou</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> </span></span>
<span class="r-in"><span>  <span class="fu">tp_sinks_sources</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 0 × 8</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 8 variables: Country &lt;chr&gt;, Method &lt;chr&gt;, Energy.type &lt;chr&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   Last.stage &lt;chr&gt;, Year &lt;dbl&gt;, Ledger.side &lt;chr&gt;, Unit &lt;chr&gt;, Flow &lt;chr&gt;</span></span>
<span class="r-in"><span><span class="fu"><a href="load_tidy_iea_df.html">load_tidy_iea_df</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="specify_primary_production.html">specify_primary_production</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="specify_interface_industries.html">specify_interface_industries</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="specify_tp_eiou.html">specify_tp_eiou</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> </span></span>
<span class="r-in"><span>  <span class="fu">tp_sinks_sources</span><span class="op">(</span>type <span class="op">=</span> <span class="st">"sources"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 0 × 8</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 8 variables: Country &lt;chr&gt;, Method &lt;chr&gt;, Energy.type &lt;chr&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   Last.stage &lt;chr&gt;, Year &lt;dbl&gt;, Ledger.side &lt;chr&gt;, Unit &lt;chr&gt;, Flow &lt;chr&gt;</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Matthew Heun, Emmanuel Aramendia, Zeke Marshall.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>


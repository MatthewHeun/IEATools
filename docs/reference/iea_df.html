<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Load IEA data from an extended enegy balances csv file — iea_df • IEATools</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Load IEA data from an extended enegy balances csv file — iea_df" />
<meta property="og:description" content="This function reads an IEA extended energy balances file and
converts it to a data frame with appropriately-labelled columns.
One of iea_file or text must be specified, but not both.
The first line of iea_file or text
is expected to start with expected_start_1st_line, and
the second line is expected to start with expected_2nd_line_start, and
it may have any number of commas appended.
(The extra commas might come from opening and re-saving the file in Excel.)
If those conditions are not met, execution is halted, and
an error message is given." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">IEATools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.11</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/IEATools.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/final_to_useful.html">Final to Useful Analysis</a>
    </li>
    <li>
      <a href="../articles/prep_psut.html">Prepare for PSUT analysis</a>
    </li>
    <li>
      <a href="../articles/specify.html">Specify EIOU Industries and Flows</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Load IEA data from an extended enegy balances csv file</h1>
    
    <div class="hidden name"><code>iea_df.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function reads an IEA extended energy balances file and
converts it to a data frame with appropriately-labelled columns.
One of <code>iea_file</code> or <code>text</code> must be specified, but not both.
The first line of <code>iea_file</code> or <code>text</code>
is expected to start with <code>expected_start_1st_line</code>, and
the second line is expected to start with <code>expected_2nd_line_start</code>, and
it may have any number of commas appended.
(The extra commas might come from opening and re-saving the file in Excel.)
If those conditions are not met, execution is halted, and
an error message is given.</p>
    </div>

    <pre class="usage"><span class='fu'>iea_df</span>(
  <span class='kw'>.iea_file</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>text</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>expected_1st_line_start</span> <span class='kw'>=</span> <span class='st'>",,TIME"</span>,
  <span class='kw'>expected_2nd_line_start</span> <span class='kw'>=</span> <span class='st'>"COUNTRY,FLOW,PRODUCT"</span>,
  <span class='kw'>missing_data</span> <span class='kw'>=</span> <span class='st'>".."</span>,
  <span class='kw'>not_applicable_data</span> <span class='kw'>=</span> <span class='st'>"x"</span>,
  <span class='kw'>confidential_data</span> <span class='kw'>=</span> <span class='st'>"c"</span>,
  <span class='kw'>estimated_year</span> <span class='kw'>=</span> <span class='st'>"E"</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>.iea_file</th>
      <td><p>a string containing the path to a .csv file of extended energy balances from the IEA.
Default is the path to a sample IEA file provided in this package.</p></td>
    </tr>
    <tr>
      <th>text</th>
      <td><p>a character string that can be parsed as IEA extended energy balances.
(This argument is useful for testing.)</p></td>
    </tr>
    <tr>
      <th>expected_1st_line_start</th>
      <td><p>the expected start of the first line of <code>iea_file</code>. Default is "<code>,,TIME</code>".</p></td>
    </tr>
    <tr>
      <th>expected_2nd_line_start</th>
      <td><p>the expected start of the second line of <code>iea_file</code>. Default is "<code>COUNTRY,FLOW,PRODUCT</code>".</p></td>
    </tr>
    <tr>
      <th>missing_data</th>
      <td><p>a string that identifies missing data. Default is "<code>..</code>".
Entries of "<code>missing_data</code>" are coded as `0`` in output.</p></td>
    </tr>
    <tr>
      <th>not_applicable_data</th>
      <td><p>a string that identifies not-applicable data. Default is "x".
Entries of "<code>not_applicable_data</code>" are coded as <code>0</code> in output.</p></td>
    </tr>
    <tr>
      <th>confidential_data</th>
      <td><p>a string that identifies confidential data. Default is "c".
Entries of "<code>confidential_data</code>" are coded as <code>0</code> in output.</p></td>
    </tr>
    <tr>
      <th>estimated_year</th>
      <td><p>a string that identifies an estimated year.
Default is "E".
E.g., in "2014E", the "E" indicates that data for 2014 are estimated.
Data from estimated years is removed from output.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a data frame containing the IEA extended energy balances data</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function is designed to work even as more years are added
in columns at the right of <code>.iea_file</code>,
because column names in the output are constructed from the first two lines of <code>iea_file</code>
(which contain years and country, flow, product information).</p>
<p>The IEA data have indicators for
not applicable values ("<code>x</code>") and for
unavailable values ("<code>..</code>").
(See "World Energy Balances: Database Documentation (2018 edition)" at
<a href='http://wds.iea.org/wds/pdf/worldbal_documentation.pdf'>http://wds.iea.org/wds/pdf/worldbal_documentation.pdf</a>.)
<code>R</code> has three concepts that could be used for "<code>x</code>" and "<code>..</code>":
<code>0</code> would indicate value known to be zero.
<code>NULL</code> would indicate an undefined value.
<code>NA</code> would indicate a value that is unavailable.
In theory, mapping from the IEA's indicators to <code>R</code> should proceed as follows:
"<code>..</code>" (unavailable) in the IEA data would be converted to <code>NA</code> in <code>R</code>.
"<code>x</code>" (not applicable) in the IEA data would be converted to <code>0</code> in <code>R</code>.
"<code>NULL</code>" would not be used.
However, the IEA are not consistent with their coding.
In some places "<code>..</code>" is used for not applicable values
(e.g., World Anthracite supply in 1971).
World Anthracite supply in 1971 is actually not applicable, because Anthracite was
classified under "Hard coal (if no detail)" in 1971.
On the other hand, "<code>..</code>" is used for data in the most recent year
when those data have not yet been incorporated into the database.
In the face of IEA’s inconsistencies,
the only rational way to proceed is to convert
both "<code>x</code>" and "<code>..</code>" to "<code>0</code>"
in this function.
Furthermore, confidential data (coded by the IEA as "<code>c</code>") is also interpreted as <code>0</code>.
(What else can we do?)</p>
<p>The data frame returned from this function is not ready to be used in R,
because rows are not unique.
To further prepre the data frame for use, call <code>augment_iea_data()</code>,
passing the output of this function in the <code>.iea_df</code> argument of <code>augment_iea_data()</code>.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Original file format</span>
<span class='fu'>iea_df</span>(<span class='kw'>text</span> <span class='kw'>=</span> <span class='st'>",,TIME,1960,1961\nCOUNTRY,FLOW,PRODUCT\nWorld,Production,Hard coal,42,43"</span>)</div><div class='output co'>#&gt;   COUNTRY       FLOW   PRODUCT 1960 1961
#&gt; 1   World Production Hard coal   42   43</div><div class='input'><span class='co'># With extra commas on the 2nd line</span>
<span class='fu'>iea_df</span>(<span class='kw'>text</span> <span class='kw'>=</span> <span class='st'>",,TIME,1960,1961\nCOUNTRY,FLOW,PRODUCT,,\nWorld,Production,Hard coal,42,43"</span>)</div><div class='output co'>#&gt;   COUNTRY       FLOW   PRODUCT 1960 1961
#&gt; 1   World Production Hard coal   42   43</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Matthew Heun.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>



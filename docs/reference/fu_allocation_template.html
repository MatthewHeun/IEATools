<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Create a template for analysis of final-to-useful transformation processes — fu_allocation_template • IEATools</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create a template for analysis of final-to-useful transformation processes — fu_allocation_template"><meta name="description" content="This function creates a blank template for final-to-useful energy transformation process analysis.
The template is a data frame derived from IEA extended energy balance data (.tidy_iea_df),
which gives both energy industry own use and final demand for final energy carriers.
From the IEA's final energy information, templates are created for conversion to
useful energy carriers.
Final energy consumed by each final demand sector or transformation process machine
is allocated to final-to-useful machines and converted to useful energy at some efficiency.
The allocation fractions are to be supplied by the analyst by filling blanks in
the template."><meta property="og:description" content="This function creates a blank template for final-to-useful energy transformation process analysis.
The template is a data frame derived from IEA extended energy balance data (.tidy_iea_df),
which gives both energy industry own use and final demand for final energy carriers.
From the IEA's final energy information, templates are created for conversion to
useful energy carriers.
Final energy consumed by each final demand sector or transformation process machine
is allocated to final-to-useful machines and converted to useful energy at some efficiency.
The allocation fractions are to be supplied by the analyst by filling blanks in
the template."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">IEATools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.76</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/IEATools.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/final_to_useful.html">Final to Useful Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/fix_iea_data.html">Fixes for IEA Data</a></li>
    <li><a class="dropdown-item" href="../articles/prep_psut.html">Prepare for PSUT analysis</a></li>
    <li><a class="dropdown-item" href="../articles/psut_names.html">PSUT Names</a></li>
    <li><a class="dropdown-item" href="../articles/specify.html">Specify EIOU Industries and Flows</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Create a template for analysis of final-to-useful transformation processes</h1>

      <div class="d-none name"><code>fu_allocation_template.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function creates a blank template for final-to-useful energy transformation process analysis.
The template is a data frame derived from IEA extended energy balance data (<code>.tidy_iea_df</code>),
which gives both energy industry own use and final demand for final energy carriers.
From the IEA's final energy information, templates are created for conversion to
useful energy carriers.
Final energy consumed by each final demand sector or transformation process machine
is allocated to final-to-useful machines and converted to useful energy at some efficiency.
The allocation fractions are to be supplied by the analyst by filling blanks in
the template.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fu_allocation_template</span><span class="op">(</span></span>
<span>  <span class="va">.tidy_iea_df</span>,</span>
<span>  energy_type <span class="op">=</span> <span class="fu">IEATools</span><span class="fu">::</span><span class="va"><a href="iea_cols.html">iea_cols</a></span><span class="op">$</span><span class="va">energy_type</span>,</span>
<span>  energy <span class="op">=</span> <span class="fu">IEATools</span><span class="fu">::</span><span class="va"><a href="energy_types.html">energy_types</a></span><span class="op">$</span><span class="va">e</span>,</span>
<span>  last_stage <span class="op">=</span> <span class="fu">IEATools</span><span class="fu">::</span><span class="va"><a href="iea_cols.html">iea_cols</a></span><span class="op">$</span><span class="va">last_stage</span>,</span>
<span>  final <span class="op">=</span> <span class="fu">IEATools</span><span class="fu">::</span><span class="va"><a href="all_stages.html">all_stages</a></span><span class="op">$</span><span class="va">final</span>,</span>
<span>  year <span class="op">=</span> <span class="fu">IEATools</span><span class="fu">::</span><span class="va"><a href="iea_cols.html">iea_cols</a></span><span class="op">$</span><span class="va">year</span>,</span>
<span>  ledger_side <span class="op">=</span> <span class="fu">IEATools</span><span class="fu">::</span><span class="va"><a href="iea_cols.html">iea_cols</a></span><span class="op">$</span><span class="va">ledger_side</span>,</span>
<span>  consumption <span class="op">=</span> <span class="fu">IEATools</span><span class="fu">::</span><span class="va"><a href="ledger_sides.html">ledger_sides</a></span><span class="op">$</span><span class="va">consumption</span>,</span>
<span>  flow_aggregation_point <span class="op">=</span> <span class="fu">IEATools</span><span class="fu">::</span><span class="va"><a href="iea_cols.html">iea_cols</a></span><span class="op">$</span><span class="va">flow_aggregation_point</span>,</span>
<span>  eiou <span class="op">=</span> <span class="fu">IEATools</span><span class="fu">::</span><span class="va"><a href="tfc_compare_flows.html">tfc_compare_flows</a></span><span class="op">$</span><span class="va">energy_industry_own_use</span>,</span>
<span>  non_energy_use <span class="op">=</span> <span class="fu">IEATools</span><span class="fu">::</span><span class="va"><a href="tfc_flows.html">tfc_flows</a></span><span class="op">$</span><span class="va">non_energy_use</span>,</span>
<span>  tfc <span class="op">=</span> <span class="fu">IEATools</span><span class="fu">::</span><span class="va"><a href="aggregation_flows.html">aggregation_flows</a></span><span class="op">$</span><span class="va">total_final_consumption</span>,</span>
<span>  tpes <span class="op">=</span> <span class="fu">IEATools</span><span class="fu">::</span><span class="va"><a href="tfc_compare_flows.html">tfc_compare_flows</a></span><span class="op">$</span><span class="va">total_primary_energy_supply</span>,</span>
<span>  flow <span class="op">=</span> <span class="fu">IEATools</span><span class="fu">::</span><span class="va"><a href="iea_cols.html">iea_cols</a></span><span class="op">$</span><span class="va">flow</span>,</span>
<span>  product <span class="op">=</span> <span class="fu">IEATools</span><span class="fu">::</span><span class="va"><a href="iea_cols.html">iea_cols</a></span><span class="op">$</span><span class="va">product</span>,</span>
<span>  destination <span class="op">=</span> <span class="fu">IEATools</span><span class="fu">::</span><span class="va"><a href="template_cols.html">template_cols</a></span><span class="op">$</span><span class="va">destination</span>,</span>
<span>  quantity <span class="op">=</span> <span class="fu">IEATools</span><span class="fu">::</span><span class="va"><a href="template_cols.html">template_cols</a></span><span class="op">$</span><span class="va">quantity</span>,</span>
<span>  e_dot <span class="op">=</span> <span class="fu">IEATools</span><span class="fu">::</span><span class="va"><a href="iea_cols.html">iea_cols</a></span><span class="op">$</span><span class="va">e_dot</span>,</span>
<span>  e_dot_total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">e_dot</span>, <span class="st">".total"</span><span class="op">)</span>,</span>
<span>  perc_unit_string <span class="op">=</span> <span class="st">"[%]"</span>,</span>
<span>  e_dot_perc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">e_dot</span>, <span class="va">perc_unit_string</span><span class="op">)</span>,</span>
<span>  maximum_values <span class="op">=</span> <span class="fu">IEATools</span><span class="fu">::</span><span class="va"><a href="template_cols.html">template_cols</a></span><span class="op">$</span><span class="va">maximum_values</span>,</span>
<span>  year_for_maximum_values <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  ef_product <span class="op">=</span> <span class="fu">IEATools</span><span class="fu">::</span><span class="va"><a href="template_cols.html">template_cols</a></span><span class="op">$</span><span class="va">ef_product</span>,</span>
<span>  allocation_var <span class="op">=</span> <span class="st">"C_"</span>,</span>
<span>  n_allocation_rows <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  machine <span class="op">=</span> <span class="fu">IEATools</span><span class="fu">::</span><span class="va"><a href="template_cols.html">template_cols</a></span><span class="op">$</span><span class="va">machine</span>,</span>
<span>  eu_product <span class="op">=</span> <span class="fu">IEATools</span><span class="fu">::</span><span class="va"><a href="template_cols.html">template_cols</a></span><span class="op">$</span><span class="va">eu_product</span>,</span>
<span>  arrange <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  .value <span class="op">=</span> <span class="st">".value"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg--tidy-iea-df">.tidy_iea_df<a class="anchor" aria-label="anchor" href="#arg--tidy-iea-df"></a></dt>
<dd><p>a tidy data frame containing IEA extended energy balance data</p></dd>


<dt id="arg-energy-type">energy_type<a class="anchor" aria-label="anchor" href="#arg-energy-type"></a></dt>
<dd><p>the name of the energy type column. Default is "EnergyType".</p></dd>


<dt id="arg-energy">energy<a class="anchor" aria-label="anchor" href="#arg-energy"></a></dt>
<dd><p>the string identifier for energy (as opposed to exergy) in the <code>energy_type</code> column. Default is "<code>E</code>".</p></dd>


<dt id="arg-last-stage">last_stage<a class="anchor" aria-label="anchor" href="#arg-last-stage"></a></dt>
<dd><p>the name of the last stage column. Default is "LastStage".</p></dd>


<dt id="arg-final">final<a class="anchor" aria-label="anchor" href="#arg-final"></a></dt>
<dd><p>the string identifier for final energy (as <code>Last.stage</code>). Default is "Final".</p></dd>


<dt id="arg-year">year<a class="anchor" aria-label="anchor" href="#arg-year"></a></dt>
<dd><p>the name of the year column. Default is "Year".</p></dd>


<dt id="arg-ledger-side">ledger_side<a class="anchor" aria-label="anchor" href="#arg-ledger-side"></a></dt>
<dd><p>the name of the ledger side column. Default is "LedgerSide".</p></dd>


<dt id="arg-consumption">consumption<a class="anchor" aria-label="anchor" href="#arg-consumption"></a></dt>
<dd><p>the string identifier for the consumption side of the ledger. Default is "Consumption".</p></dd>


<dt id="arg-flow-aggregation-point">flow_aggregation_point<a class="anchor" aria-label="anchor" href="#arg-flow-aggregation-point"></a></dt>
<dd><p>the name of the flow aggregation point column. Default is FlowAggregationPoint.</p></dd>


<dt id="arg-eiou">eiou<a class="anchor" aria-label="anchor" href="#arg-eiou"></a></dt>
<dd><p>the string identifier for energy industry own use in <code>flow_aggregation_point</code>. Default is "Energy industry own use".</p></dd>


<dt id="arg-non-energy-use">non_energy_use<a class="anchor" aria-label="anchor" href="#arg-non-energy-use"></a></dt>
<dd><p>string identifier for non-energy use in <code>flow_aggregation_point</code>. Default is "Non-energy use".</p></dd>


<dt id="arg-tfc">tfc<a class="anchor" aria-label="anchor" href="#arg-tfc"></a></dt>
<dd><p>the string identifier for total final consumption. Default is "Total final consumption".</p></dd>


<dt id="arg-tpes">tpes<a class="anchor" aria-label="anchor" href="#arg-tpes"></a></dt>
<dd><p>the string identifier for total primary energy supply. Default is "Total primary energy supply".</p></dd>


<dt id="arg-flow">flow<a class="anchor" aria-label="anchor" href="#arg-flow"></a></dt>
<dd><p>the name of the flow column. Default is "Flow".</p></dd>


<dt id="arg-product">product<a class="anchor" aria-label="anchor" href="#arg-product"></a></dt>
<dd><p>the name of the product column. Default is "Product".</p></dd>


<dt id="arg-destination">destination<a class="anchor" aria-label="anchor" href="#arg-destination"></a></dt>
<dd><p>the name for the destination column. Default is "Destination".</p></dd>


<dt id="arg-quantity">quantity<a class="anchor" aria-label="anchor" href="#arg-quantity"></a></dt>
<dd><p>the name of the quantity column. Default is "Quantity".</p></dd>


<dt id="arg-e-dot">e_dot<a class="anchor" aria-label="anchor" href="#arg-e-dot"></a></dt>
<dd><p>the name of the energy flow rate column. Default is "Edot".</p></dd>


<dt id="arg-e-dot-total">e_dot_total<a class="anchor" aria-label="anchor" href="#arg-e-dot-total"></a></dt>
<dd><p>the string identifier for total energy. Default is "Edot.total".</p></dd>


<dt id="arg-perc-unit-string">perc_unit_string<a class="anchor" aria-label="anchor" href="#arg-perc-unit-string"></a></dt>
<dd><p>the string used to indicate percentages. Default is "<code>[%]</code>".</p></dd>


<dt id="arg-e-dot-perc">e_dot_perc<a class="anchor" aria-label="anchor" href="#arg-e-dot-perc"></a></dt>
<dd><p>the string identifier for energy percentage. Default is "Edot.perc".</p></dd>


<dt id="arg-maximum-values">maximum_values<a class="anchor" aria-label="anchor" href="#arg-maximum-values"></a></dt>
<dd><p>the name for the maximum energy values column. Default is "Maximum values".</p></dd>


<dt id="arg-year-for-maximum-values">year_for_maximum_values<a class="anchor" aria-label="anchor" href="#arg-year-for-maximum-values"></a></dt>
<dd><p>an integer for the first year (in which maximum values will be stored before renaming the column to <code>maximum_values</code>).
Default is <code>0</code>.</p></dd>


<dt id="arg-ef-product">ef_product<a class="anchor" aria-label="anchor" href="#arg-ef-product"></a></dt>
<dd><p>the name of the final energy carrier column. Default is "Ef product".</p></dd>


<dt id="arg-allocation-var">allocation_var<a class="anchor" aria-label="anchor" href="#arg-allocation-var"></a></dt>
<dd><p>the string identifier for the allocation percentage column. Default is "C_".</p></dd>


<dt id="arg-n-allocation-rows">n_allocation_rows<a class="anchor" aria-label="anchor" href="#arg-n-allocation-rows"></a></dt>
<dd><p>an integer stating how many allocation rows are desired. Default is <code>3</code>.</p></dd>


<dt id="arg-machine">machine<a class="anchor" aria-label="anchor" href="#arg-machine"></a></dt>
<dd><p>the name of the column of final-to-useful transformation process machines. Default is "Machine".</p></dd>


<dt id="arg-eu-product">eu_product<a class="anchor" aria-label="anchor" href="#arg-eu-product"></a></dt>
<dd><p>the name of the useful energy carrier column. Default is "Eu product".</p></dd>


<dt id="arg-arrange">arrange<a class="anchor" aria-label="anchor" href="#arg-arrange"></a></dt>
<dd><p>a boolean telling whether to arranged the rows and columns
(using <code><a href="arrange_iea_fu_allocation_template.html">arrange_iea_fu_allocation_template()</a></code>) before returning.
Default is <code>TRUE</code>.</p></dd>


<dt id="arg--value">.value<a class="anchor" aria-label="anchor" href="#arg--value"></a></dt>
<dd><p>the name of a temporary value column added to <code>.tidy_iea_df</code>.
A <code>.value</code> column must not be present in <code>.tidy_iea_df</code>. Default is ".value".</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a data frame containing the EIOU template</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Non-energy use is removed from <code>.tidy_iea_df</code> before creating the template.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="load_tidy_iea_df.html">load_tidy_iea_df</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="specify_all.html">specify_all</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> </span></span>
<span class="r-in"><span>  <span class="fu">fu_allocation_template</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 906 × 15</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Country Method EnergyType LastStage LedgerSide FlowAggregationPoint    Unit </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> GHA     PCM    E          Final     Supply     Energy industry own use TJ   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> GHA     PCM    E          Final     Supply     Energy industry own use TJ   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> GHA     PCM    E          Final     Supply     Energy industry own use TJ   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> GHA     PCM    E          Final     Supply     Energy industry own use TJ   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> GHA     PCM    E          Final     Supply     Energy industry own use TJ   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> GHA     PCM    E          Final     Supply     Energy industry own use TJ   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> GHA     PCM    E          Final     Supply     Energy industry own use TJ   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> GHA     PCM    E          Final     Supply     Energy industry own use TJ   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> GHA     PCM    E          Final     Supply     Energy industry own use TJ   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> GHA     PCM    E          Final     Supply     Energy industry own use TJ   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 896 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 8 more variables: EfProduct &lt;chr&gt;, Machine &lt;dbl&gt;, EuProduct &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   Destination &lt;chr&gt;, Quantity &lt;chr&gt;, MaximumValues &lt;dbl&gt;, `1971` &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   `2000` &lt;dbl&gt;</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matthew Kuperus Heun, Emmanuel Aramendia, Zeke Marshall.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>


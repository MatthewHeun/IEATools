<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Perform quality assurance on a raw IEA data file — iea_file_OK • IEATools</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Perform quality assurance on a raw IEA data file — iea_file_OK"><meta name="description" content="When starting to work with an IEA data file,
it is important to verify its integrity.
This function performs some validation tests on .iea_file."><meta property="og:description" content="When starting to work with an IEA data file,
it is important to verify its integrity.
This function performs some validation tests on .iea_file."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">IEATools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.78</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/IEATools.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/final_to_useful.html">Final to Useful Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/fix_iea_data.html">Fixes for IEA Data</a></li>
    <li><a class="dropdown-item" href="../articles/prep_psut.html">Prepare for PSUT analysis</a></li>
    <li><a class="dropdown-item" href="../articles/psut_names.html">PSUT Names</a></li>
    <li><a class="dropdown-item" href="../articles/specify.html">Specify EIOU Industries and Flows</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Perform quality assurance on a raw IEA data file</h1>

      <div class="d-none name"><code>iea_file_OK.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>When starting to work with an IEA data file,
it is important to verify its integrity.
This function performs some validation tests on <code>.iea_file</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">iea_file_OK</span><span class="op">(</span></span>
<span>  .iea_file <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  text <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  expected_1st_line_start <span class="op">=</span> <span class="st">",,TIME"</span>,</span>
<span>  expected_2nd_line_start <span class="op">=</span> <span class="st">"COUNTRY,FLOW,PRODUCT"</span>,</span>
<span>  expected_simple_start <span class="op">=</span> <span class="va">expected_2nd_line_start</span>,</span>
<span>  .slurped_iea_df <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  country <span class="op">=</span> <span class="st">"COUNTRY"</span>,</span>
<span>  flow <span class="op">=</span> <span class="st">"FLOW"</span>,</span>
<span>  product <span class="op">=</span> <span class="st">"PRODUCT"</span>,</span>
<span>  rowid <span class="op">=</span> <span class="st">"rowid"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg--iea-file">.iea_file<a class="anchor" aria-label="anchor" href="#arg--iea-file"></a></dt>
<dd><p>The path to the raw IEA data file for which quality assurance is desired.
Can be a vector of file paths, in which case
each file is loaded sequentially and stacked together
with <code><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">dplyr::bind_rows()</a></code>.</p></dd>


<dt id="arg-text">text<a class="anchor" aria-label="anchor" href="#arg-text"></a></dt>
<dd><p>a string containing text to be parsed as an IEA file.</p></dd>


<dt id="arg-expected-st-line-start">expected_1st_line_start<a class="anchor" aria-label="anchor" href="#arg-expected-st-line-start"></a></dt>
<dd><p>the expected start of the first line of <code>iea_file</code>. Default is ",,TIME".</p></dd>


<dt id="arg-expected-nd-line-start">expected_2nd_line_start<a class="anchor" aria-label="anchor" href="#arg-expected-nd-line-start"></a></dt>
<dd><p>the expected start of the second line of <code>iea_file</code>. Default is "COUNTRY,FLOW,PRODUCT".</p></dd>


<dt id="arg-expected-simple-start">expected_simple_start<a class="anchor" aria-label="anchor" href="#arg-expected-simple-start"></a></dt>
<dd><p>the expected starting of the first line of <code>iea_file</code>. Default is the value of <code>expected_2nd_line_start</code>.
Note that <code>expected_simple_start</code> is sometimes encountered in data supplied by the IEA.
Furthermore, <code>expected_simple_start</code> could be the format of the file when somebody "helpfully" fiddles with
the raw data from the IEA.</p></dd>


<dt id="arg--slurped-iea-df">.slurped_iea_df<a class="anchor" aria-label="anchor" href="#arg--slurped-iea-df"></a></dt>
<dd><p>a data frame created by <code><a href="slurp_iea_to_raw_df.html">slurp_iea_to_raw_df()</a></code></p></dd>


<dt id="arg-country">country<a class="anchor" aria-label="anchor" href="#arg-country"></a></dt>
<dd><p>the name of the country column. Default is "COUNTRY".</p></dd>


<dt id="arg-flow">flow<a class="anchor" aria-label="anchor" href="#arg-flow"></a></dt>
<dd><p>the name of the flow column. Default is "FLOW".</p></dd>


<dt id="arg-product">product<a class="anchor" aria-label="anchor" href="#arg-product"></a></dt>
<dd><p>the name of the product column. Default is "PRODUCT".</p></dd>


<dt id="arg-rowid">rowid<a class="anchor" aria-label="anchor" href="#arg-rowid"></a></dt>
<dd><p>the name of a row number column added internally to <code>.iea_file</code> per country. Default is "rowid".</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>TRUE</code> if <code>.iea_file</code> passes all checks. Errors are thrown when a verification step fails.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>At this time, the only verification step performed by this function
is confirming that every country has the same flow and product rows in the same order.
The approach is to add a per-country row number column to the data frame and delete all the data in year columns.
Then, the resulting data frame is queried for duplicate row numbers.
If none are found, the function returns the data frame read from the file.</p>
<p>Note that <code>.iea_file</code> is read internally with <code><a href="https://rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">data.table::fread()</a></code> <em>without</em> stripping white space.</p>
<p>If <code>.slurped_iea_df</code> is supplied, arguments <code>.iea_file</code> or <code>text</code> are ignored.
If <code>.slurped_iea_df</code> is <code>NULL</code> (the default),
either <code>.iea_file</code> or <code>text</code> are required, and
the helper function <code><a href="slurp_iea_to_raw_df.html">slurp_iea_to_raw_df()</a></code> is called internally
to load a raw data frame of data.</p>
<p>This function is vectorized over <code>.iea_file</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="sample_iea_data_path.html">sample_iea_data_path</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> </span></span>
<span class="r-in"><span> <span class="fu">iea_file_OK</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matthew Kuperus Heun, Emmanuel Aramendia, Zeke Marshall.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>


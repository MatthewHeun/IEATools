<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Perform quality assurance on a raw IEA data file — iea_file_OK • IEATools</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Perform quality assurance on a raw IEA data file — iea_file_OK" />
<meta property="og:description" content="When starting to work with an IEA data file,
it is important to verify its integrity.
This function performs some validation tests on .iea_file." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">IEATools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.30</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/IEATools.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/final_to_useful.html">Final to Useful Analysis</a>
    </li>
    <li>
      <a href="../articles/fix_iea_data.html">Fixes for IEA Data</a>
    </li>
    <li>
      <a href="../articles/prep_psut.html">Prepare for PSUT analysis</a>
    </li>
    <li>
      <a href="../articles/specify.html">Specify EIOU Industries and Flows</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Perform quality assurance on a raw IEA data file</h1>
    
    <div class="hidden name"><code>iea_file_OK.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>When starting to work with an IEA data file,
it is important to verify its integrity.
This function performs some validation tests on <code>.iea_file</code>.</p>
    </div>

    <pre class="usage"><span class='fu'>iea_file_OK</span>(
  <span class='kw'>.iea_file</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>text</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>expected_1st_line_start</span> <span class='kw'>=</span> <span class='st'>",,TIME"</span>,
  <span class='kw'>expected_2nd_line_start</span> <span class='kw'>=</span> <span class='st'>"COUNTRY,FLOW,PRODUCT"</span>,
  <span class='kw'>expected_simple_start</span> <span class='kw'>=</span> <span class='no'>expected_2nd_line_start</span>,
  <span class='kw'>.slurped_iea_df</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>country</span> <span class='kw'>=</span> <span class='st'>"COUNTRY"</span>,
  <span class='kw'>flow</span> <span class='kw'>=</span> <span class='st'>"FLOW"</span>,
  <span class='kw'>product</span> <span class='kw'>=</span> <span class='st'>"PRODUCT"</span>,
  <span class='kw'>rowid</span> <span class='kw'>=</span> <span class='st'>"rowid"</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>.iea_file</th>
      <td><p>the path to the raw IEA data file for which quality assurance is desired</p></td>
    </tr>
    <tr>
      <th>text</th>
      <td><p>a string containing text to be parsed as an IEA file.</p></td>
    </tr>
    <tr>
      <th>expected_1st_line_start</th>
      <td><p>the expected start of the first line of <code>iea_file</code>. Default is ",,TIME".</p></td>
    </tr>
    <tr>
      <th>expected_2nd_line_start</th>
      <td><p>the expected start of the second line of <code>iea_file</code>. Default is "COUNTRY,FLOW,PRODUCT".</p></td>
    </tr>
    <tr>
      <th>expected_simple_start</th>
      <td><p>the expected starting of the first line of <code>iea_file</code>. Default is the value of <code>expected_2nd_line_start</code>.
Note that <code>expected_simple_start</code> is sometimes encountered in data supplied by the IEA.
Furthermore, <code>expected_simple_start</code> could be the format of the file when somebody "helpfully" fiddles with
the raw data from the IEA.</p></td>
    </tr>
    <tr>
      <th>.slurped_iea_df</th>
      <td><p>a data frame created by <code><a href='slurp_iea_to_raw_df.html'>slurp_iea_to_raw_df()</a></code></p></td>
    </tr>
    <tr>
      <th>country</th>
      <td><p>the name of the country column. Default is "COUNTRY".</p></td>
    </tr>
    <tr>
      <th>flow</th>
      <td><p>the name of the flow column. Default is "FLOW".</p></td>
    </tr>
    <tr>
      <th>product</th>
      <td><p>the name of the product column. Default is "PRODUCT".</p></td>
    </tr>
    <tr>
      <th>rowid</th>
      <td><p>the name of a row number column added internally to <code>.iea_file</code> per country. Default is "rowid".</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>TRUE</code> if <code>.iea_file</code> passes all checks. Errors are thrown when a verification step fails.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>At this time, the only verification step performed by this function
is confirming that every country has the same flow and product rows in the same order.
The approach is to add a per-country row number column to the data frame and delete all the data in year columns.
Then, the resulting data frame is queried for duplicate row numbers.
If none are found, the function returns the data frame read from the file.</p>
<p>Note that <code>.iea_file</code> is read internally with <code><a href='https://Rdatatable.gitlab.io/data.table/reference/fread.html'>data.table::fread()</a></code> <em>without</em> stripping white space.</p>
<p>If <code>.slurped_iea_df</code> is supplied, arguments <code>.iea_file</code> or <code>text</code> are ignored.
If <code>.slurped_iea_df</code> is absent,
either <code>.iea_file</code> or <code>text</code> are required, and
the helper function <code><a href='slurp_iea_to_raw_df.html'>slurp_iea_to_raw_df()</a></code> is called internally
to load a raw data frame of data.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>magrittr</span>)</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘magrittr’</span></div><div class='output co'>#&gt; <span class='message'>The following objects are masked from ‘package:testthat’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    equals, is_less_than, not</span></div><div class='input'><span class='fu'><a href='sample_iea_data_path.html'>sample_iea_data_path</a></span>() <span class='kw'>%&gt;%</span>
 <span class='fu'>iea_file_OK</span>()</div><div class='output co'>#&gt; [1] TRUE</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Matthew Heun.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>



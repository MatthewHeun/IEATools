<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Write blank final-to-useful templates — write_fu_allocation_template • IEATools</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Write blank final-to-useful templates — write_fu_allocation_template"><meta name="description" content="The analyst often starts with IEA extended energy balance data covering primary and final energy stages.
This function writes a blank Excel template file that, when filled,
allow the energy conversion chain to be extended to the useful stage.
This function saves an Excel workbook to path that contains an analyst's template."><meta property="og:description" content="The analyst often starts with IEA extended energy balance data covering primary and final energy stages.
This function writes a blank Excel template file that, when filled,
allow the energy conversion chain to be extended to the useful stage.
This function saves an Excel workbook to path that contains an analyst's template."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">IEATools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.77</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/IEATools.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/final_to_useful.html">Final to Useful Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/fix_iea_data.html">Fixes for IEA Data</a></li>
    <li><a class="dropdown-item" href="../articles/prep_psut.html">Prepare for PSUT analysis</a></li>
    <li><a class="dropdown-item" href="../articles/psut_names.html">PSUT Names</a></li>
    <li><a class="dropdown-item" href="../articles/specify.html">Specify EIOU Industries and Flows</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Write blank final-to-useful templates</h1>

      <div class="d-none name"><code>write_fu_allocation_template.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The analyst often starts with IEA extended energy balance data covering primary and final energy stages.
This function writes a blank Excel template file that, when filled,
allow the energy conversion chain to be extended to the useful stage.
This function saves an Excel workbook to <code>path</code> that contains an analyst's template.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">write_fu_allocation_template</span><span class="op">(</span></span>
<span>  <span class="va">.fu_allocation_template</span>,</span>
<span>  <span class="va">path</span>,</span>
<span>  ledger_side <span class="op">=</span> <span class="fu">IEATools</span><span class="fu">::</span><span class="va"><a href="iea_cols.html">iea_cols</a></span><span class="op">$</span><span class="va">ledger_side</span>,</span>
<span>  consumption <span class="op">=</span> <span class="fu">IEATools</span><span class="fu">::</span><span class="va"><a href="ledger_sides.html">ledger_sides</a></span><span class="op">$</span><span class="va">consumption</span>,</span>
<span>  flow_aggregation_point <span class="op">=</span> <span class="fu">IEATools</span><span class="fu">::</span><span class="va"><a href="iea_cols.html">iea_cols</a></span><span class="op">$</span><span class="va">flow_aggregation_point</span>,</span>
<span>  eiou <span class="op">=</span> <span class="fu">IEATools</span><span class="fu">::</span><span class="va"><a href="tfc_compare_flows.html">tfc_compare_flows</a></span><span class="op">$</span><span class="va">energy_industry_own_use</span>,</span>
<span>  fu_allocations_tab_name <span class="op">=</span> <span class="fu">IEATools</span><span class="fu">::</span><span class="va"><a href="fu_analysis_file_info.html">fu_analysis_file_info</a></span><span class="op">$</span><span class="va">fu_allocation_tab_name</span>,</span>
<span>  machine <span class="op">=</span> <span class="fu">IEATools</span><span class="fu">::</span><span class="va"><a href="template_cols.html">template_cols</a></span><span class="op">$</span><span class="va">machine</span>,</span>
<span>  eu_product <span class="op">=</span> <span class="fu">IEATools</span><span class="fu">::</span><span class="va"><a href="template_cols.html">template_cols</a></span><span class="op">$</span><span class="va">eu_product</span>,</span>
<span>  quantity <span class="op">=</span> <span class="fu">IEATools</span><span class="fu">::</span><span class="va"><a href="template_cols.html">template_cols</a></span><span class="op">$</span><span class="va">quantity</span>,</span>
<span>  e_dot <span class="op">=</span> <span class="fu">IEATools</span><span class="fu">::</span><span class="va"><a href="iea_cols.html">iea_cols</a></span><span class="op">$</span><span class="va">e_dot</span>,</span>
<span>  e_dot_perc <span class="op">=</span> <span class="fu">IEATools</span><span class="fu">::</span><span class="va"><a href="template_cols.html">template_cols</a></span><span class="op">$</span><span class="va">e_dot_perc</span>,</span>
<span>  maximum_values <span class="op">=</span> <span class="fu">IEATools</span><span class="fu">::</span><span class="va"><a href="template_cols.html">template_cols</a></span><span class="op">$</span><span class="va">maximum_values</span>,</span>
<span>  header_row_font_color <span class="op">=</span> <span class="st">"#FFFFFF"</span>,</span>
<span>  header_row_shading_color <span class="op">=</span> <span class="st">"#5A80B8"</span>,</span>
<span>  energy_row_font_color_fd <span class="op">=</span> <span class="st">"#104273"</span>,</span>
<span>  energy_row_shading_color_fd <span class="op">=</span> <span class="st">"#B8D8F5"</span>,</span>
<span>  energy_row_font_color_eiou <span class="op">=</span> <span class="st">"#918700"</span>,</span>
<span>  energy_row_shading_color_eiou <span class="op">=</span> <span class="st">"#FCFCAB"</span>,</span>
<span>  dont_fill_shading_color <span class="op">=</span> <span class="st">"#A8A8A8"</span>,</span>
<span>  overwrite_file <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  n_allocation_rows <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  .rownum <span class="op">=</span> <span class="st">".rownum"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg--fu-allocation-template">.fu_allocation_template<a class="anchor" aria-label="anchor" href="#arg--fu-allocation-template"></a></dt>
<dd><p>a data frame produced by <code><a href="fu_allocation_template.html">fu_allocation_template()</a></code></p></dd>


<dt id="arg-path">path<a class="anchor" aria-label="anchor" href="#arg-path"></a></dt>
<dd><p>the file path into which the blank template file will be written.
Include both folder and file name.
If not present, the ".xlsx" extension is added.</p></dd>


<dt id="arg-ledger-side">ledger_side<a class="anchor" aria-label="anchor" href="#arg-ledger-side"></a></dt>
<dd><p>the name of the ledger side column in <code>.tidy_iea_df</code>. Default is <code>IEATools::iea_cols$ledger_side</code>.</p></dd>


<dt id="arg-consumption">consumption<a class="anchor" aria-label="anchor" href="#arg-consumption"></a></dt>
<dd><p>the string identifier for consumption in the <code>ledger_side</code> column.  Default is <code>IEATools::ledger_sides$consumption</code>.</p></dd>


<dt id="arg-flow-aggregation-point">flow_aggregation_point<a class="anchor" aria-label="anchor" href="#arg-flow-aggregation-point"></a></dt>
<dd><p>the name of the flow aggregation point column in <code>.tidy_iea_df</code>. Default is <code>IEATools::iea_cols$flow_aggregation_point</code>.</p></dd>


<dt id="arg-eiou">eiou<a class="anchor" aria-label="anchor" href="#arg-eiou"></a></dt>
<dd><p>the string identifier for energy industry own use in the <code>flow_aggregation_point</code> column. Default is <code>IEATools::tfc_compare_flows$energy_industry_own_use</code>.</p></dd>


<dt id="arg-fu-allocations-tab-name">fu_allocations_tab_name<a class="anchor" aria-label="anchor" href="#arg-fu-allocations-tab-name"></a></dt>
<dd><p>the name of the tab on which the template will be written. Default is <code>IEATools::fu_analysis_file_info$fu_allocation_tab_name</code>.</p></dd>


<dt id="arg-machine">machine<a class="anchor" aria-label="anchor" href="#arg-machine"></a></dt>
<dd><p>the name of the machine column in output. Default is <code>IEATools::template_cols$machine</code>.</p></dd>


<dt id="arg-eu-product">eu_product<a class="anchor" aria-label="anchor" href="#arg-eu-product"></a></dt>
<dd><p>the name of the useful energy product column in output. Default is <code>IEATools::template_cols$eu_product</code>.</p></dd>


<dt id="arg-quantity">quantity<a class="anchor" aria-label="anchor" href="#arg-quantity"></a></dt>
<dd><p>the name of the quantity column to be created on output. Default is <code>IEATools::template_cols$quantity</code>.</p></dd>


<dt id="arg-e-dot">e_dot<a class="anchor" aria-label="anchor" href="#arg-e-dot"></a></dt>
<dd><p>the name of the energy flow rate column in <code>.tidy_iea_df</code> and the name of the energy flow rate rows to be included in the Excel file that is written by this function.
Default is "Edot".</p></dd>


<dt id="arg-e-dot-perc">e_dot_perc<a class="anchor" aria-label="anchor" href="#arg-e-dot-perc"></a></dt>
<dd><p>the name of the energy flow rate percentage row to be included in the Excel file that is written by this function.
Default is "Edot.perc".</p></dd>


<dt id="arg-maximum-values">maximum_values<a class="anchor" aria-label="anchor" href="#arg-maximum-values"></a></dt>
<dd><p>the name of the maximum values column in output. Default is <code>IEATools::template_cols$maximum_values</code>.</p></dd>


<dt id="arg-header-row-font-color">header_row_font_color<a class="anchor" aria-label="anchor" href="#arg-header-row-font-color"></a></dt>
<dd><p>a hex string representing the font color for the header row in the Excel file that is written by this function.
Default is "#FFFFFF", white.</p></dd>


<dt id="arg-header-row-shading-color">header_row_shading_color<a class="anchor" aria-label="anchor" href="#arg-header-row-shading-color"></a></dt>
<dd><p>a hex string representing the shading color for the header row in the Excel file that is written by this function.
Default is "#5A80B8", medium blue.</p></dd>


<dt id="arg-energy-row-font-color-fd">energy_row_font_color_fd<a class="anchor" aria-label="anchor" href="#arg-energy-row-font-color-fd"></a></dt>
<dd><p>a hex string representing the font color for <code>e_dot</code> and <code>e_dot_perc</code> final demand rows in the Excel file that is written by this function.
Default is "#104273", a dark blue color.</p></dd>


<dt id="arg-energy-row-shading-color-fd">energy_row_shading_color_fd<a class="anchor" aria-label="anchor" href="#arg-energy-row-shading-color-fd"></a></dt>
<dd><p>a hex string representing the shading color for <code>e_dot</code> and <code>e_dot_perc</code> final demand rows in the Excel file that is written by this function.
Default is "#104273", a light blue color.</p></dd>


<dt id="arg-energy-row-font-color-eiou">energy_row_font_color_eiou<a class="anchor" aria-label="anchor" href="#arg-energy-row-font-color-eiou"></a></dt>
<dd><p>a hex string representing the font color for <code>e_dot</code> and <code>e_dot_perc</code> energy industry own use rows in the Excel file that is written by this function.
Default is "#104273", a dark yellow color.</p></dd>


<dt id="arg-energy-row-shading-color-eiou">energy_row_shading_color_eiou<a class="anchor" aria-label="anchor" href="#arg-energy-row-shading-color-eiou"></a></dt>
<dd><p>a hex string representing the shading color for <code>e_dot</code> and <code>e_dot_perc</code> energy industry own use rows in the Excel file that is written by this function.
Default is "#104273", a light yellow color.</p></dd>


<dt id="arg-dont-fill-shading-color">dont_fill_shading_color<a class="anchor" aria-label="anchor" href="#arg-dont-fill-shading-color"></a></dt>
<dd><p>a hex string representing the shading color for cells that don't require inputs.
Default is "#A8A8A8", a medium gray color.</p></dd>


<dt id="arg-overwrite-file">overwrite_file<a class="anchor" aria-label="anchor" href="#arg-overwrite-file"></a></dt>
<dd><p>a boolean that tells whether an existing file at <code>path</code> will be overwritten. Default is <code>FALSE</code>.
If <code>path</code> already exists and <code>overwrite = FALSE</code>, an error is given.</p></dd>


<dt id="arg-n-allocation-rows">n_allocation_rows<a class="anchor" aria-label="anchor" href="#arg-n-allocation-rows"></a></dt>
<dd><p>the number of allocation rows to write for each final energy product. Default is <code>3</code>.</p></dd>


<dt id="arg--rownum">.rownum<a class="anchor" aria-label="anchor" href="#arg--rownum"></a></dt>
<dd><p>a temporary column created internally. <code>.rownum</code> must not exist in <code>.tidy_iea_df</code> when <code>write_fu_allocation_template</code> is called.
Default is ".rownum".</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>the value of the <code>path</code> argument</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Allocations are to be placed in <code>C_x</code> rows of the template.</p>
<p>Formatting is applied to the template:</p><ul><li><p>Gray cells indicate cells that will be ignored when the template is read later.
Analysts may fill those cells, but it is not necessary to do so.</p></li>
<li><p>Blue cells indicate final demand energy consumption.</p></li>
<li><p>Yellow cells indicate energy industry own use energy consumption.</p></li>
<li><p>Rows are written in same order as IEA extended energy balance data.</p></li>
<li><p>Columns are written in a reasonable order, namely that left-to-right order
approximates flow through the energy conversion chain.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".xlsx"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="load_tidy_iea_df.html">load_tidy_iea_df</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="specify_all.html">specify_all</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="fu_allocation_template.html">fu_allocation_template</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> </span></span>
<span class="r-in"><span>  <span class="fu">write_fu_allocation_template</span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "/tmp/RtmpJZRlD6/file1c0a3a4d3e7.xlsx"</span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.remove</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matthew Kuperus Heun, Emmanuel Aramendia, Zeke Marshall.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

